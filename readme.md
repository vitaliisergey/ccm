Version 1.0.0  

Руководство по установке ccm-test проекта
=========================================

Установка окружения (считается что Java 8 установлена в системе):

1. Скачайте Tomcat 9 (Core) по [ссылке](http://tomcat.apache.org/download-90.cgi) и разархивируйте его

2. Скачайте Gradle ver. 3.3 по [ссылке](https://gradle.org/install#manually) 
 1. Распакуйте архив и укажите путь в переменной окружения Path к папке */bin* в распакованном архиве.
 
 
3. Скачайте и установите PostgreSQL по [ссылке](https://www.postgresql.org/download/windows/)
 
  1. Создайте новую роль входа с именем **cc-prod** и паролем **password**
  2. Создайте базу с именем **ccm** и владельцем **ccm-prod**
  3. Создайте в базе новую схему с именем **prod**
 
Сборка проекта
=========================================
1. Скачайте проект с этого репозитория

  1. В консоле перейдите в папку с проектом и выполните команду `gradle build`
  2. Скопируйте файл ccm-test.war из папки */build/libs* в папку Tomcat-а */webapps*
  3. Скопируйте папку */conf* из папки проекта в корневую дерикторию Tomcat.  
    В папке */conf* находятся настройки для подключения к базе PostgreSQL.  
    В файле */conf/ccm/ccm.properties* проверьте правильность имени\пароля, схемы и имени базы, в соответствии с созданными ранее

  4. Перейдите в папку */bin* Tomcat и запустите файл startup.bat.  
    

Логирование
=========================================
 - Логирование сохраняется в папку */logs* Tomcat  
 - Файлы сегодняшнего дня сохраняются ccm-common.log
 - Файлы прошедших дней хранятся ccm-common-{date}.log, где {date} дата файла
 - На файловой системе хранится логирование последних 100 дней(возможно изменить)
 - Конфигурация логирования может менятся без перезапуска Tomcat  
  
Запуск тестов
=========================================

  - Запуск тестов может быть выполнен из консоли в папке с проектом командой `gradle clean test` 
  - Также в будущем тесты на любом CI сервере (соответствующие xml файлы расположены в папке */build*  
  - Визуализацию результатов работы тестов можно посмотреть в папке */build/reports/tests/test*  

Возможные проблемы
=========================================
1. При выполнении команд `gradle build` или `gradle clean test` в консоль выводится сообщение `"gradle" не является внутренней или внешней
командой, исполняемой программой или пакетным файлом.`  
Причина - не указан или неверно указан путь к папке с Gradle в переменной Path.  
Проверить корректную настройку можно командой `gradle -version`  

2. При запуске Tomcat в логе присутствует ошибка `org.springframework.beans.factory.BeanInitializationException: Could not load properties;`.  
Причина - не скопирована папка */conf* в корневую папку Tomcat

3. При запуске Tomcat в логе присутствует ошибка `FATAL: password authentication failed for user "****"`.  
Причина - роль входа, указанная в */conf/ccm/ccm.properties* не совпадает ни с одной ролью в базе
